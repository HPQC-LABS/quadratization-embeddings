%% LyX 2.3.0 created this file.  For more info, see http://www.lyx.org/.
%% Do not edit unless you really know what you are doing.
\documentclass[english,showpacs,preprintnumbers,amssymb,aps,notitlepage,twocolumn]{revtex4-1}
\usepackage{lmodern}
\renewcommand{\sfdefault}{lmss}
\renewcommand{\ttdefault}{lmtt}
\usepackage[T1]{fontenc}
\usepackage[latin9]{inputenc}
\setcounter{secnumdepth}{3}
\usepackage{color}
\usepackage{array}
\usepackage{multirow}

\makeatletter

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% LyX specific LaTeX commands.
%% Binom macro for standard LaTeX users
\newcommand{\binom}[2]{{#1 \choose #2}}

%% Because html converters don't know tabularnewline
\providecommand{\tabularnewline}{\\}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% User specified LaTeX commands.
\usepackage{amsfonts,amsmath} % amsmath added here instead to prevent clash with lyx function
\input{tikzit/tikz_premable.tex}
\newcommand{\intextheight}{13 pt}

\@ifundefined{showcaptionsetup}{}{%
 \PassOptionsToPackage{caption=false}{subfig}}
\usepackage{subfig}
\makeatother

\usepackage{babel}
\begin{document}

\title{Embedding quadratization gadgets on Chimera and Pegasus graphs}

\author{Nike Dattani}
\email{n.dattani@cfa.harvard.edu}

\selectlanguage{english}%

\affiliation{Harvard-Smithsonian Center for Astrophysics}

\author{Nicholas Chancellor}
\email{nicholas.chancellor@durham.ac.uk}

\selectlanguage{english}%

\affiliation{Durham University}
\begin{abstract}
We group all known quadratizations of cubic and quartic binary optimization
problems into five and seven unique graphs respectively. We then perform
a minor embedding of these graphs onto the well-known Chimera graph,
and the brand new \emph{Pegasus} graph. In cases where two or more
graphs have a minor embedding with the same overhead in terms of auxiliary
variables, we make recommendations for which gadgets are best to use
for certain problems. 
\end{abstract}
\maketitle
Discrete optimization problems are often naturally formulated in terms
of minimizing some polynomial of degree $>2$, which is then `quadratized'
into a quadratic function which can be solved using standard algorithms
for universal classical computers {[}1{]}, using special-purpose classical
annealers {[}2{]}, or using quantum annealers {[}3{]}. With dozens
of quadratization methods available {[}4{]}, one should choose the
best quadratization for a given problem, and for a given method for
solving the problem. 

\noindent 
\begin{figure*}
\caption{\label{fig:allGraphGadgets}}

\newcommand{\thisfigheight}{1.5 cm}

\subfloat[``\emph{all to aux}'']{

\resizebox{!}{\thisfigheight}{\input{tikzit/all_to_aux.tikz}}}\subfloat[``\emph{Y}'']{

\resizebox{!}{\thisfigheight}{\input{tikzit/logical_fork.tikz} }}\subfloat[\mbox{``\emph{coat hanger}''}]{

\resizebox{!}{\thisfigheight}{\input{tikzit/k4_missing_2edge.tikz}
}}\subfloat[]{

\resizebox{!}{\thisfigheight}{\input{tikzit/k4_missing_edge.tikz}
}}\subfloat[``\emph{all to all}'']{

\resizebox{!}{\thisfigheight}{\input{tikzit/k4.tikz}}}

\subfloat[\emph{``all to aux''}]{

\resizebox{!}{\thisfigheight}{\input{tikzit/all_to_aux4.tikz}}}\subfloat[``\emph{tripod}'']{

\resizebox{!}{\thisfigheight}{\input{tikzit/logical_fork3.tikz}}}\subfloat[``\emph{all to two aux + 1}'']{\resizebox{!}{\thisfigheight}{\input{tikzit/2aux_to_all4_1conn.tikz}}}\subfloat[``\emph{all to all - 1}'']{

\resizebox{!}{\thisfigheight}{\input{tikzit/2aux_to_all4_allConn.tikz}
}}\subfloat[``\emph{all to aux + $K_{4}$}'']{ 

\resizebox{!}{\thisfigheight}{\input{tikzit/2auxConn_to_all4_allConn.tikz}}}\subfloat[``\emph{all to aux} again'']{

\resizebox{!}{\thisfigheight}{\input{tikzit/aux_to_all4_allConn.tikz}}}\subfloat[``\emph{two $K_{4}'s$}'']{

\resizebox{!}{\thisfigheight}{\input{tikzit/2k4_shared_aux.tikz}}}
\end{figure*}

There are ways to quadratize functions of discrete variables without
adding any auxiliary variables {[}5{]}, but when those methods cannot
be applied we introduce auxiliary variables. The resulting quadratic
functions (called `gadgets') that accurately or exactly simulate the
original high-degree functions, will have some connectivity between
the binary variables (or bits, or qubits, herein referred to for convenience
only as qubits) which can be represented by a graph in which vertices
represent qubits and edges indicate when two different qubits appear
together in a quadratic term. Since this graph incorporates no information
about the linear terms, constant term, or the coefficients of the
quadratic terms, many different gadgets have the same graph, therefore
in this paper we will classify all known quadratization gadgets into
categories according to their corresponding graph (herein called their
`gadget graph'). 

Gadget graphs for all known single cubic terms and for all known single
quartic terms are given in Figure \ref{fig:allGraphGadgets}. Gadget
graphs tell us a lot about how costly the quadratic optimization problem
will be, and those with larger connectivity tend to yield more difficult
functions to optimize. Furthermore, some optimization methods only
work if their corresponding graph has a certain connectivity, two
examples of such connectivities being the ones in D-Wave's well-known
Chimera graph {[}5{]}, and in their very recently presented \emph{Pegasus}
graph, both shown in Fig. \ref{fig:ChimeraAndPegasus}.

\begin{table}[b]
\caption{}

\rule{1\columnwidth}{0.5pt}

\begin{tabular*}{1\columnwidth}{@{\extracolsep{\fill}}ccccc}
\hline 
\noalign{\vskip2mm}
\multirow{2}{*}{{\footnotesize{}Gadget Graph}} & \multirow{2}{*}{{\footnotesize{}Example Gadgets}} & {\footnotesize{}$N_{{\rm aux}}$} & {\footnotesize{}$N_{{\rm aux}}$ } & {\footnotesize{}$N_{{\rm aux}}$ }\tabularnewline
 &  & {\scriptsize{}Quadratization} & {\scriptsize{}Chimera} & {\scriptsize{}Pegasus}\tabularnewline[2mm]
\hline 
\noalign{\vskip2mm}
\multicolumn{5}{c}{Cubic $\rightarrow$ Quadratic}\tabularnewline[2mm]
\hline 
\noalign{\vskip2mm}
\multirow{2}{*}{\textbf{\textcolor{blue}{\scriptsize{}All to Aux}}} & {\scriptsize{}NTR-KZFD} & \multirow{2}{*}{{\scriptsize{}1}} & \multirow{2}{*}{{\scriptsize{}0}} & \multirow{2}{*}{{\scriptsize{}0}}\tabularnewline
 & {\scriptsize{}NTR-ABCG} &  &  & \tabularnewline[0.5mm]
\textbf{\textcolor{blue}{\scriptsize{}Y}} & {\scriptsize{}NTR-ABCB} & {\scriptsize{}1} & {\scriptsize{}0} & {\scriptsize{}0}\tabularnewline[0.5mm]
\textbf{\textcolor{blue}{\scriptsize{}Coat Hanger}} & {\scriptsize{}AR} & {\scriptsize{}1} & {\scriptsize{}1} & {\scriptsize{}0}\tabularnewline[0.5mm]
\textbf{\textcolor{blue}{\scriptsize{}(d)}} & {\scriptsize{}ACR} & {\scriptsize{}1} &  & {\scriptsize{}0}\tabularnewline[0.5mm]
\multirow{3}{*}{\textbf{\textcolor{blue}{\scriptsize{}All to All}}} & {\scriptsize{}PTR-Ishikawa} & \multirow{3}{*}{{\scriptsize{}1}} & \multirow{3}{*}{} & \multirow{3}{*}{{\scriptsize{}0}}\tabularnewline
 & {\scriptsize{}PTR-BCR(1-4)} &  &  & \tabularnewline
 & {\scriptsize{}PTR-KZ} &  &  & \tabularnewline[2mm]
\hline 
\noalign{\vskip2mm}
\multicolumn{5}{c}{{\scriptsize{}Quartic $\rightarrow$ Quadratic}}\tabularnewline[2mm]
\hline 
\noalign{\vskip2mm}
\textbf{\textcolor{blue}{\scriptsize{}All2Aux}} & {\scriptsize{}NTR-KZFD} & {\scriptsize{}1} & {\scriptsize{}0} & {\scriptsize{}0}\tabularnewline
\textbf{\textcolor{blue}{\scriptsize{}Tripod}} & {\scriptsize{}NTR-ABCB} & {\scriptsize{}1} & {\scriptsize{}0} & {\scriptsize{}0}\tabularnewline
\textbf{\textcolor{blue}{\scriptsize{}All22Aux+1}} & {\scriptsize{}PTR} & {\scriptsize{}2} & {\scriptsize{}1} & {\scriptsize{}0}\tabularnewline
\textbf{\textcolor{blue}{\scriptsize{}All2All - 1}} & {\scriptsize{}PTR-Ishikawa} & {\scriptsize{}2} & {\scriptsize{}?} & {\scriptsize{}2}\tabularnewline
\multirow{2}{*}{\textbf{\textcolor{blue}{\scriptsize{}All2Aux+$K_{4}$}}} & {\scriptsize{}PTR-BCR-2} & \multirow{2}{*}{{\scriptsize{}1}} & \multirow{2}{*}{{\scriptsize{}3}} & \multirow{2}{*}{{\scriptsize{}2}}\tabularnewline
 & {\scriptsize{}PTR-BCR-4} &  &  & \tabularnewline
\textbf{\textcolor{blue}{\scriptsize{}All2Aux}} & {\scriptsize{}PTR-BCR-3} & {\scriptsize{}2} & {\scriptsize{}?} & {\scriptsize{}2}\tabularnewline
\textbf{\textcolor{blue}{\scriptsize{}Two $K_{4}'s$}} & {\scriptsize{}PTR-KZ} & {\scriptsize{}3} & {\scriptsize{}?} & {\scriptsize{}1}\tabularnewline[2mm]
\hline 
\end{tabular*}

\rule{1\columnwidth}{0.5pt}
\end{table}

\begin{figure}
\caption{\label{fig:ChimeraAndPegasus}}
\end{figure}

Any graph, can be mapped onto the Chimera or Pegasus graphs by minor-embedding
{[}6{]}, where the Chimera graph or the Pegasus graph is a graph minor
of the graph representing the problem that needs to be optimized.
This often means that one binary variable in the quadratic optimization
problem needs to be represented by two qubits instead of one, making
the number of qubits needed to solve the original problem much larger
than before, and sometimes completely impossible. For example a quartic
function with 1000 binary variables has $\binom{1000}{3}>166$ million
possible cubic terms and $\binom{1000}{4}>40$ billion possible quartic
terms which have to be quadratized, and then minor-embedded. If our
minimization method can only be applied for up to 50 billion qubits,
we cannot afford for each quartic-to-quadratic gadget to require its
own auxiliary qubit for minor-embedding.

We have provided minor-embeddings for all gadget graphs in Figure
\ref{fig:allGraphGadgets}, for both Chimera and Pegasus. We note
that \textbf{\emph{all}} cubic to quadratic gadgets involvnig one
auxiliary qubit can be embedded onto Pegasus without any further auxiliary
qubits for the embedding, because Pegasus contains the $K_{4}$ graph,
which means any possible connections between the three logical qubits
and the one auxiliary qubit are already contained in Pegasus. Since
Chimera does not contain $K_{4}$, only negative cubic terms are so
far known to be quadratizable with gadgets that embed directly onto
Chimera without any extra qubits for the embedding.

\section{Minor embeddings for cubic to quadratic gadgets}

\subsection{Chimera graph}

\begin{figure*}
\caption{Minor embeddings of all cubic to quadratic gadgets onto a `unit cell'
of a Chimera graph. Transparent vertices and edges are not used. Thick
black edges denote graph minors, in which two physical qubits (two
vertices) represent one logical qubit (this is done when logical qubits
need to be connected to more qubits than the Chimera unit cell otherwise
allows).}

\newcommand{\chimeraFigSize}{3cm}

\subfloat[``\emph{all to aux''}]{\resizebox{!}{\chimeraFigSize}{\input{tikzit/all_to_aux_chimera.tikz}}}\subfloat[``\emph{Y''}]{\resizebox{!}{\chimeraFigSize}{\input{tikzit/logical_fork_chimera.tikz}}}\subfloat[``\emph{coat hanger''}]{\resizebox{!}{\chimeraFigSize}{\input{tikzit/k4_missing_2edge_chimera.tikz}}}\subfloat[``\emph{''}]{\resizebox{!}{\chimeraFigSize}{\input{tikzit/k4_missing_edge_chimera.tikz}}}\subfloat[``\emph{all to all''}]{\resizebox{!}{\chimeraFigSize}{\input{tikzit/k4_chimera.tikz}}}

\end{figure*}


\end{document}
